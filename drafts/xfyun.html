<!doctype html>
<html class="no-js" lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<title>kamidox.com</title>
		<meta name="description" content="">
		<meta name="author" content="Joey Huang">

		<link rel="stylesheet" href="../theme/css/foundation.css" />
		<link rel="stylesheet" href="../theme/css/pygment/monokai.css" />
		<link rel="stylesheet" href="../theme/css/custom.css" />


		<link rel="shortcut icon" href="../theme/img/favicon.ico">

		<script src="../theme/js/modernizr.js"></script>

		<!-- Feeds -->


		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
		<script>
		MathJax.Hub.Config({
		  config: ["MMLorHTML.js"],
		  extensions: ["tex2jax.js"],
		  jax: ["input/TeX", "output/HTML-CSS", "output/NativeMML"],
		  tex2jax: {
		    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
		    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
		    processEscapes: true
		  },
		  TeX: {
		    extensions: ["AMSmath.js", "AMSsymbols.js"],
		    TagSide: "right",
		    TagIndent: ".8em",
		    MultLineWidth: "85%",
		    equationNumbers: {
		      autoNumber: "AMS",
		    },
		    unicode: {
		      fonts: "STIXGeneral,'Arial Unicode MS'"
		    }
		  },
		  displayAlign: "center",
		  showProcessingMessages: false,
		  messageStyle: 'none'
		});
		</script>
	</head>
	<body>
		<div class="off-canvas-wrap">
			<div class="inner-wrap">
				<!-- mobile top bar to activate nav -->
				<nav class="tab-bar show-for-small">
					<section class="left-small">
						<a class="left-off-canvas-toggle menu-icon" ><span></span></a>
					</section>

					<section class="middle tab-bar-section">
						<h1 class="title">kamidox.com</h1>
					</section>
				</nav>

				<!-- mobile side bar nav -->
				<aside class="left-off-canvas-menu">
					<ul class="off-canvas-list">
							<li><a href="http://blog.kamidox.com">Home</a></li>
							<li><a href="http://blog.kamidox.com/about.html">About</a></li>

						<li><label>Categories</label></li>
							<li ><a href="../category/android.html">android</a></li>
							<li ><a href="../category/essay.html">essay</a></li>
							<li ><a href="../category/flask.html">flask</a></li>
							<li ><a href="../category/ml.html">ml</a></li>
							<li ><a href="../category/nlp.html">nlp</a></li>
							<li ><a href="../category/python.html">python</a></li>
							<li ><a href="../category/tools.html">tools</a></li>
							<li ><a href="../category/weapp.html">weapp</a></li>
							<li ><a href="../category/web.html">web</a></li>
							<li ><a href="../category/werkzeug.html">werkzeug</a></li>




						<li><label>Monthly Archives</label></li>
									<li><a href="/posts/2018/03/index.html">March 2018 (1)</a></li>
									<li><a href="/posts/2017/05/index.html">May 2017 (2)</a></li>
									<li><a href="/posts/2017/04/index.html">April 2017 (1)</a></li>
									<li><a href="/posts/2017/02/index.html">February 2017 (1)</a></li>
									<li><a href="/posts/2017/01/index.html">January 2017 (1)</a></li>
									<li><a href="/posts/2016/12/index.html">December 2016 (2)</a></li>
									<li><a href="/posts/2016/11/index.html">November 2016 (3)</a></li>
									<li><a href="/posts/2016/10/index.html">October 2016 (1)</a></li>
									<li><a href="/posts/2016/09/index.html">September 2016 (1)</a></li>
									<li><a href="/posts/2016/03/index.html">March 2016 (2)</a></li>
									<li><a href="/posts/2016/02/index.html">February 2016 (2)</a></li>
									<li><a href="/posts/2016/01/index.html">January 2016 (2)</a></li>
									<li><a href="/posts/2015/12/index.html">December 2015 (10)</a></li>
									<li><a href="/posts/2015/11/index.html">November 2015 (6)</a></li>
									<li><a href="/posts/2015/10/index.html">October 2015 (2)</a></li>
									<li><a href="/posts/2015/09/index.html">September 2015 (7)</a></li>
									<li><a href="/posts/2015/08/index.html">August 2015 (1)</a></li>
									<li><a href="/posts/2015/07/index.html">July 2015 (1)</a></li>
									<li><a href="/posts/2015/05/index.html">May 2015 (1)</a></li>
									<li><a href="/posts/2015/04/index.html">April 2015 (1)</a></li>
									<li><a href="/posts/2015/03/index.html">March 2015 (3)</a></li>
									<li><a href="/posts/2015/02/index.html">February 2015 (2)</a></li>
									<li><a href="/posts/2015/01/index.html">January 2015 (2)</a></li>
									<li><a href="/posts/2014/12/index.html">December 2014 (3)</a></li>
									<li><a href="/posts/2014/11/index.html">November 2014 (4)</a></li>
									<li><a href="/posts/2014/10/index.html">October 2014 (6)</a></li>
									<li><a href="/posts/2014/09/index.html">September 2014 (1)</a></li>
									<li><a href="/posts/2014/07/index.html">July 2014 (1)</a></li>


					</ul>
				</aside>

				<!-- top bar nav -->
				<nav class="top-bar hide-for-small-only" data-topbar>
					<ul class="title-area">
						<li class="name">
							<h1><a href="../">kamidox.com</a></h1>
						</li>
					</ul>

					<section class="top-bar-section">
						<ul class="left">
								<li><a href="http://blog.kamidox.com">Home</a></li>
								<li><a href="http://blog.kamidox.com/about.html">About</a></li>

						</ul>
					</section>
				</nav>

				<!-- Main Page Content and Sidebar -->
				<section class="main-section">
					<div class="row">
						<!-- Main Content -->
						<div class="medium-9 small-12 columns" role="content">
<article>
	<h2>迅飞语义识别集成向导</h2>
	<h2 id="_1">如何集成迅飞语义识别向导</h2>
<div class="toc">
<ul>
<li><a href="#_1">如何集成迅飞语义识别向导</a><ul>
<li><a href="#_2">准备工作</a></li>
<li><a href="#_3">开启语义识别服务</a></li>
<li><a href="#sdk">下载 SDK</a></li>
<li><a href="#_4">查阅智能家居语义开发文档</a></li>
<li><a href="#_5">语义识别举例</a><ul>
<li><a href="#_6">能正确识别的语义</a></li>
<li><a href="#_7">不能正确识别的语义</a></li>
</ul>
</li>
<li><a href="#_8">实现策略</a></li>
</ul>
</li>
</ul>
</div>
<h3 id="_2">准备工作</h3>
<ul>
<li><a href="http://www.xfyun.cn/">申请开发者账号</a></li>
<li>新建应用</li>
</ul>
<h3 id="_3">开启语义识别服务</h3>
<ul>
<li><a href="http://www.xfyun.cn/index.php/services/osp">启用服务</a></li>
<li><a href="http://osp.voicecloud.cn/">配置语义</a>，打开<a href="http://osp.voicecloud.cn/index.php/default/app/control">语义管理</a>，在<code>通用语义场景</code>点击<code>设置</code>，配置智能家居的语义场景，目前是配置五个：<strong>窗帘，灯，空调，电视，开关</strong></li>
</ul>
<h3 id="sdk">下载 SDK</h3>
<p><a href="http://www.xfyun.cn/sdk/dispatcher">下载 SDK</a>，查看里面的 Demo 完成语义识别 Demo 开发。</p>
<p>比如，针对 Android 平台的代码如下：</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008800; font-style: italic">//1.创建文本语义理解对象</span>
SpeechUnderstander understander <span style="color: #666666">=</span> SpeechUnderstander<span style="color: #666666">.</span><span style="color: #BB4444">createUnderstander</span><span style="color: #666666">(</span>context<span style="color: #666666">,</span> <span style="color: #AA22FF; font-weight: bold">null</span><span style="color: #666666">);</span>
<span style="color: #008800; font-style: italic">//2.设置参数，语义场景配置请登录http://osp.voicecloud.cn/</span>
understander<span style="color: #666666">.</span><span style="color: #BB4444">setParameter</span><span style="color: #666666">(</span>SpeechConstant<span style="color: #666666">.</span><span style="color: #BB4444">LANGUAGE</span><span style="color: #666666">,</span> <span style="color: #BB4444">&quot;zh_cn&quot;</span><span style="color: #666666">);</span>
<span style="color: #008800; font-style: italic">//3.开始语义理解</span>
understander<span style="color: #666666">.</span><span style="color: #BB4444">startUnderstanding</span><span style="color: #666666">(</span>mUnderstanderListener<span style="color: #666666">);</span>
<span style="color: #008800; font-style: italic">// XmlParser为结果解析类，见SpeechDemo</span>
<span style="color: #AA22FF; font-weight: bold">private</span> SpeechUnderstanderListener mUnderstanderListener <span style="color: #666666">=</span> <span style="color: #AA22FF; font-weight: bold">new</span> SpeechUnderstanderListener<span style="color: #666666">(){</span>
<span style="color: #AA22FF; font-weight: bold">public</span> <span style="color: #00BB00; font-weight: bold">void</span> <span style="color: #00A000">onResult</span><span style="color: #666666">(</span>UnderstanderResult result<span style="color: #666666">)</span> <span style="color: #666666">{</span>
            String text <span style="color: #666666">=</span> result<span style="color: #666666">.</span><span style="color: #BB4444">getResultString</span><span style="color: #666666">();</span>
<span style="color: #666666">}</span>
    <span style="color: #AA22FF; font-weight: bold">public</span> <span style="color: #00BB00; font-weight: bold">void</span> <span style="color: #00A000">onError</span><span style="color: #666666">(</span>SpeechError error<span style="color: #666666">)</span> <span style="color: #666666">{}</span><span style="color: #008800; font-style: italic">//会话发生错误回调接口</span>
    <span style="color: #AA22FF; font-weight: bold">public</span> <span style="color: #00BB00; font-weight: bold">void</span> <span style="color: #00A000">onBeginOfSpeech</span><span style="color: #666666">()</span> <span style="color: #666666">{}</span><span style="color: #008800; font-style: italic">//开始录音</span>
    <span style="color: #AA22FF; font-weight: bold">public</span> <span style="color: #00BB00; font-weight: bold">void</span> <span style="color: #00A000">onVolumeChanged</span><span style="color: #666666">(</span><span style="color: #00BB00; font-weight: bold">int</span> volume<span style="color: #666666">){}</span> <span style="color: #008800; font-style: italic">//音量值0~30</span>
    <span style="color: #AA22FF; font-weight: bold">public</span> <span style="color: #00BB00; font-weight: bold">void</span> <span style="color: #00A000">onEndOfSpeech</span><span style="color: #666666">()</span> <span style="color: #666666">{}</span><span style="color: #008800; font-style: italic">//结束录音</span>
    <span style="color: #AA22FF; font-weight: bold">public</span> <span style="color: #00BB00; font-weight: bold">void</span> <span style="color: #00A000">onEvent</span><span style="color: #666666">(</span><span style="color: #00BB00; font-weight: bold">int</span> eventType<span style="color: #666666">,</span> <span style="color: #00BB00; font-weight: bold">int</span> arg1<span style="color: #666666">,</span> <span style="color: #00BB00; font-weight: bold">int</span> arg2<span style="color: #666666">,</span> Bundle obj<span style="color: #666666">)</span> <span style="color: #666666">{}</span><span style="color: #008800; font-style: italic">//扩展用接口</span>
<span style="color: #666666">};</span>
</pre></div>


<p>语义识别的结果是个 Json 字符串，比如：</p>
<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%">{
  <span style="color: #008000; font-weight: bold">&quot;semantic&quot;</span>: {
    <span style="color: #008000; font-weight: bold">&quot;slots&quot;</span>: {
      <span style="color: #008000; font-weight: bold">&quot;location&quot;</span>: {
        <span style="color: #008000; font-weight: bold">&quot;type&quot;</span>: <span style="color: #BB4444">&quot;LOC_HOUSE&quot;</span>,
        <span style="color: #008000; font-weight: bold">&quot;room&quot;</span>: <span style="color: #BB4444">&quot;客厅&quot;</span>
      },
      <span style="color: #008000; font-weight: bold">&quot;onOff&quot;</span>: <span style="color: #BB4444">&quot;OPEN&quot;</span>
    }
  },
  <span style="color: #008000; font-weight: bold">&quot;rc&quot;</span>: <span style="color: #666666">0</span>,
  <span style="color: #008000; font-weight: bold">&quot;device&quot;</span>: <span style="color: #BB4444">&quot;airControl&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;service&quot;</span>: <span style="color: #BB4444">&quot;smartHome&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;operation&quot;</span>: <span style="color: #BB4444">&quot;OPEN&quot;</span>,
  <span style="color: #008000; font-weight: bold">&quot;text&quot;</span>: <span style="color: #BB4444">&quot;把客厅的空调打开&quot;</span>
}
</pre></div>


<h3 id="_4">查阅智能家居语义开发文档</h3>
<p>查阅《语义开放平台_智能家居场景协议规范文档_v1.0.pdf》文档。</p>
<ul>
<li>2.1 应答消息格式</li>
<li>2.2 应答消息字段定义</li>
<li>3.2 地点描述相关协议</li>
<li>4 设备服务协议<ul>
<li>4.2 窗帘</li>
<li>4.3 灯</li>
<li>4.7 电视</li>
<li>4.18 空调</li>
<li>4.30 开关</li>
</ul>
</li>
</ul>
<h3 id="_5">语义识别举例</h3>
<h4 id="_6">能正确识别的语义</h4>
<ul>
<li>把客厅的空调打开</li>
<li>把厕所的灯打开</li>
<li>把楼上的灯打开</li>
<li>把客厅的电视关掉</li>
<li>把二楼洗手间的灯打开</li>
<li>把窗帘打开一半</li>
<li>太热了</li>
<li>太冷了</li>
<li>把客厅的空调温度调高一点</li>
</ul>
<h4 id="_7">不能正确识别的语义</h4>
<ul>
<li>房间里太亮了</li>
<li>打开离家模式</li>
</ul>
<h3 id="_8">实现策略</h3>
<p>语音控制主要有两个要素，一是<strong>设备</strong>，如客厅的空调，书房的空调，厕所的电灯，餐厅的开关等等。二是<strong>动作</strong>，如打开，关闭，打开一半，调高温度等等。</p>
<ol>
<li>使用语义接口来实现（text）</li>
<li>设备定位：<br />
  2.1 设备列表（灯光1，冰箱1，灯光5）<br />
  2.2 遍历设备列表，去 text 里找 （第一优先级），如果找到，就直接使用这个设备来作为控制对象<br />
  2.3 动作：从语义识别（第一优先级），比如打开，关闭，调高，调低等。<br />
  2.4 动作：自定义的动作（调亮，调暗），根据自定义动作的关键词，从 text 里找。<br />
  2.5 人性化动作：比如，用户说太热了，语义识别会识别出打开空调，但是哪个空调呢？如果只有一个空调，那我就直接打开空调。再比如，用户说打开电视。如果只有一个电视，就直接打开。如果有多个电视，报错。<br />
  2.6 使用地点定位：比如“打开一楼客厅灯光”，如果一楼只有一个客厅，且客厅只有一个灯光，就打开。否则提示用户错误。</li>
</ol>
	<hr/>
	<h6>Post by <a href="../author/joey-huang.html">Joey Huang</a> under <a href="../category/notes.html">notes</a> on 2015-12-15(Tuesday) 15:36.</h6>
</article>

<hr/>
<div class="row">
	<div class="small-12 columns">
		<h3>Comments</h3>
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_shortname = 'kamidox';
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	</div>
</div>
						</div>
						<!-- End Main Content -->
						<!-- Sidebar -->
						<aside class="medium-3 hide-for-small-only columns">
							<div class="panel">
								<h5>Places</h5>
								<ul class="side-nav">
										<li><a href="http://blog.kamidox.com/feeds/rss.xml" rel="alternate">RSS Feed</a></li>

								</ul>
							</div>


							<div class="panel">
								<h5>Categories</h5>
								<ul class="side-nav">
										<li><a href="../category/android.html">android</a></li>
										<li><a href="../category/essay.html">essay</a></li>
										<li><a href="../category/flask.html">flask</a></li>
										<li><a href="../category/ml.html">ml</a></li>
										<li><a href="../category/nlp.html">nlp</a></li>
										<li><a href="../category/python.html">python</a></li>
										<li><a href="../category/tools.html">tools</a></li>
										<li><a href="../category/weapp.html">weapp</a></li>
										<li><a href="../category/web.html">web</a></li>
										<li><a href="../category/werkzeug.html">werkzeug</a></li>
								</ul>
							</div>

							<div class="panel">
								<h5>Tags</h5>
								<ul class="tag-cloud">
										<li class="tag-4"><a href="../tag/socketserver.html">SocketServer</a></li>
										<li class="tag-2"><a href="../tag/weapp.html">weapp</a></li>
										<li class="tag-2"><a href="../tag/flask.html">flask</a></li>
										<li class="tag-2"><a href="../tag/markdown.html">markdown</a></li>
										<li class="tag-3"><a href="../tag/web.html">web</a></li>
										<li class="tag-2"><a href="../tag/tools.html">tools</a></li>
										<li class="tag-3"><a href="../tag/sublime.html">sublime</a></li>
										<li class="tag-1"><a href="../tag/python.html">python</a></li>
										<li class="tag-4"><a href="../tag/wekzeug.html">wekzeug</a></li>
										<li class="tag-4"><a href="../tag/contacts-provider.html">contacts provider</a></li>
										<li class="tag-2"><a href="../tag/android.html">android</a></li>
										<li class="tag-4"><a href="../tag/patchrom.html">patchrom</a></li>
										<li class="tag-1"><a href="../tag/thought.html">thought</a></li>
										<li class="tag-4"><a href="../tag/nlp.html">nlp</a></li>
										<li class="tag-4"><a href="../tag/miui.html">miui</a></li>
										<li class="tag-4"><a href="../tag/decorator.html">decorator</a></li>
										<li class="tag-1"><a href="../tag/machine-learning.html">machine-learning</a></li>
										<li class="tag-4"><a href="../tag/uml.html">uml</a></li>
										<li class="tag-4"><a href="../tag/contacts.html">contacts</a></li>
										<li class="tag-4"><a href="../tag/ebook.html">ebook</a></li>
										<li class="tag-4"><a href="../tag/react.html">react</a></li>
										<li class="tag-3"><a href="../tag/pelican.html">pelican</a></li>
										<li class="tag-4"><a href="../tag/github.html">github</a></li>
								</ul>
							</div>

							<div class="panel">
								<h5>Monthly Archives</h5>
								<ul class="side-nav">
											<li><a href="/posts/2018/03/index.html">March 2018 (1)</a></li>
											<li><a href="/posts/2017/05/index.html">May 2017 (2)</a></li>
											<li><a href="/posts/2017/04/index.html">April 2017 (1)</a></li>
											<li><a href="/posts/2017/02/index.html">February 2017 (1)</a></li>
											<li><a href="/posts/2017/01/index.html">January 2017 (1)</a></li>
											<li><a href="/posts/2016/12/index.html">December 2016 (2)</a></li>
											<li><a href="/posts/2016/11/index.html">November 2016 (3)</a></li>
											<li><a href="/posts/2016/10/index.html">October 2016 (1)</a></li>
											<li><a href="/posts/2016/09/index.html">September 2016 (1)</a></li>
											<li><a href="/posts/2016/03/index.html">March 2016 (2)</a></li>
											<li><a href="/posts/2016/02/index.html">February 2016 (2)</a></li>
											<li><a href="/posts/2016/01/index.html">January 2016 (2)</a></li>
											<li><a href="/posts/2015/12/index.html">December 2015 (10)</a></li>
											<li><a href="/posts/2015/11/index.html">November 2015 (6)</a></li>
											<li><a href="/posts/2015/10/index.html">October 2015 (2)</a></li>
											<li><a href="/posts/2015/09/index.html">September 2015 (7)</a></li>
											<li><a href="/posts/2015/08/index.html">August 2015 (1)</a></li>
											<li><a href="/posts/2015/07/index.html">July 2015 (1)</a></li>
											<li><a href="/posts/2015/05/index.html">May 2015 (1)</a></li>
											<li><a href="/posts/2015/04/index.html">April 2015 (1)</a></li>
											<li><a href="/posts/2015/03/index.html">March 2015 (3)</a></li>
											<li><a href="/posts/2015/02/index.html">February 2015 (2)</a></li>
											<li><a href="/posts/2015/01/index.html">January 2015 (2)</a></li>
											<li><a href="/posts/2014/12/index.html">December 2014 (3)</a></li>
											<li><a href="/posts/2014/11/index.html">November 2014 (4)</a></li>
											<li><a href="/posts/2014/10/index.html">October 2014 (6)</a></li>
											<li><a href="/posts/2014/09/index.html">September 2014 (1)</a></li>
											<li><a href="/posts/2014/07/index.html">July 2014 (1)</a></li>
								</ul>
							</div>

						</aside>
						<!-- End Sidebar -->
					</div>

					<!-- Footer -->
					<footer class="row">
						<div class="medium-9 small-12">
							<hr/>
							<p class="text-center">Powered by <a href="http://getpelican.com">Pelican</a> and <a href="http://foundation.zurb.com/">Zurb Foundation</a>. Theme by <a href="http://hamaluik.com">Kenton Hamaluik</a>.
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253471695'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1253471695%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
							</p>
						</div>
					</footer>
					<!-- End Footer -->
				</section>
				<a class="exit-off-canvas"></a>
			</div><!--off-canvas inner-->
		</div><!--off-canvas wrap-->

		<script src="../theme/js/jquery.js"></script>
		<script src="../theme/js/foundation.min.js"></script>
		<script>
			$(document).foundation();
		</script>
	</body>
</html>